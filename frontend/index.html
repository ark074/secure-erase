<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>SecureWipe</title>
  <style> body{font-family:Arial;margin:20px;} label{display:block;margin-top:8px;} pre{background:#f9f9f9;padding:10px;} </style>
</head>
<body>
  <h1>SecureWipe â€” UI</h1>
  <label>Target: <input id="target" value="demo/test.img" style="width:60%"/></label>
  <label>Profile: <select id="profile"><option value="quick">quick</option><option value="secure">secure</option></select></label>
  <label>Email: <input id="email" style="width:60%"/></label>
  <label><input id="force" type="checkbox"/> Force raw device ops</label>
  <button id="wipe">Wipe Now</button>
  <h3>Status</h3>
  <pre id="status">idle</pre>
  <h3>Jobs</h3>
  <pre id="jobs">[]</pre>
<script>
async function getJobs(){ let r=await fetch('/jobs'); let j=await r.json(); document.getElementById('jobs').textContent=JSON.stringify(j,null,2); }
document.getElementById('wipe').onclick = async ()=>{
  const payload = { device_path: document.getElementById('target').value, profile: document.getElementById('profile').value, email: document.getElementById('email').value, force: document.getElementById('force').checked };
  const resp = await fetch('/wipe',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
  const j = await resp.json();
  document.getElementById('status').textContent = 'Job queued: '+j.job_id;
  const iv = setInterval(async ()=>{ await getJobs(); const jobs = await (await fetch('/jobs')).json(); const job = jobs.find(x=>x.id===j.job_id); if(job){ document.getElementById('status').textContent = JSON.stringify(job,null,2); if(job.status==='finished' || job.status==='failed'){ clearInterval(iv); } } },2000);
}
getJobs();
</script>
</body>
</html>
